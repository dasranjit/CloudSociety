@model IEnumerable<CloudSocietyEntities.SocietyBuildingUnitBalanceWithBillReceiptExistCheck>
@{
    ViewBag.Title = "Society Building Unit Subscription Balance";
    ViewBag.Header = "Society Building Unit Subscription Balance";
    ViewBag.SocietyNameHeader = ViewBag.SocietyHead;
    Layout = "~/Views/Shared/SocietyLayout.cshtml";
    var societyBuildingUnit = (CloudSocietyEntities.SocietyBuildingUnit)ViewBag.SocietyBuildingUnit;
    IEnumerable<CloudSocietyEntities.SocietyMember> SocietyMemberList = (IEnumerable<CloudSocietyEntities.SocietyMember>)ViewBag.SocietyMembersList;    
}
<span class="SocName">Building Unit : @societyBuildingUnit.SocietyBuilding.Building
    - @societyBuildingUnit.Unit</span>
<br />
<br />
@if (SocietyMemberList.Count() > 0)
    {      
    <div class="buttton" style="width: 65px;">
        @Html.ActionLink("Create New", "Create2", new { societyBuildingUnitID = societyBuildingUnit.SocietyBuildingUnitID, societySubscriptionID = ViewBag.SocietySubscriptionID })
    </div>       
    }
<br />
<table border="0" cellpadding="2" cellspacing="0" class="table">
    @{
        int Count = 1;
    }
    @foreach (var item in Model)
    {
        if (Count == 1)
        {
        <tr>
            <th rowspan="2">
            </th>
            <th rowspan="2">
                Member
            </th>
            <th rowspan="2">
                Bill Abbr.
            </th>
            <th colspan="3">
                Principal
            </th>
            <th colspan="3">
                Interest
            </th>
            <th colspan="3">
                Special Bill
            </th>
            <th colspan="3">
                Tax
            </th>
            <th colspan="3">
                Advance
            </th>
        </tr>
        <tr>
            <th>
                Bill
            </th>
            <th>
                Receipt
            </th>
            <th>
                Balance
            </th>
            <th>
                Bill
            </th>
            <th>
                Receipt
            </th>
            <th>
                Balance
            </th>
            <th>
                Bill
            </th>
            <th>
                Receipt
            </th>
            <th>
                Balance
            </th>
            <th>
                Bill
            </th>
            <th>
                Receipt
            </th>
            <th>
                Balance
            </th>
            <th>
                Amount
            </th>
            <th>
                Adjusted
            </th>
            <th>
                Balance
            </th>
        </tr>
        }  
        <tr @if ((Count % 2) == 0)
            { <text> class="TableRow" </text> }
            else
            { <text> class="altTableRow" </text>} >
            <td>
                @if (item.BillExists == 1 || item.ReceiptExists == 1)
                {
                    <span></span>
                }
                else
                {                   
                    @Html.ActionLink("Edit", "Edit2", new { id = item.SocietyBuildingUnitSubscriptionBalanceID, societySubscriptionID = ViewBag.SocietySubscriptionID }, new { @class = "EditDelete" })
                    <span>|</span>
                    @Html.ActionLink("Delete", "Delete2", new { id = item.SocietyBuildingUnitSubscriptionBalanceID, societySubscriptionID = ViewBag.SocietySubscriptionID }, new { @class = "EditDelete" })                  
                }
            </td>
            <td>
                @item.Member
            </td>
            <td>
                @item.BillAbbreviation
            </td>
            <td align="right">
                @(item.PrincipalAmount == null ? "--" : item.PrincipalAmount.ToString())
            </td>
            <td align="right">
                @(item.PrincipalReceipt == null ? "--" : item.PrincipalReceipt.ToString())
            </td>
            <td align="right">
                @{
            var bal = (item.PrincipalAmount ?? 0) - (item.PrincipalReceipt ?? 0);
                }
                @bal
            </td>
            <td align="right">
                @(item.InterestAmount == null ? "--" : item.InterestAmount.ToString())
            </td>
            <td align="right">
                @(item.InterestReceipt == null ? "--" : item.InterestReceipt.ToString())
            </td>
            <td align="right">
                @{
            bal = (item.InterestAmount ?? 0) - (item.InterestReceipt ?? 0);
                }
                @bal
            </td>
            <td align="right">
                @(item.SpecialBillAmount == null ? "--" : item.SpecialBillAmount.ToString())
            </td>
            <td align="right">
                @(item.SpecialBillReceipt == null ? "--" : item.SpecialBillReceipt.ToString())
            </td>
            <td align="right">
                @{
            bal = (item.SpecialBillAmount ?? 0) - (item.SpecialBillReceipt ?? 0);
                }
                @bal
            </td>
            <td align="right">
                @(item.TaxAmount == null ? "--" : item.TaxAmount.ToString())
            </td>
            <td align="right">
                @(item.TaxReceipt == null ? "--" : item.TaxReceipt.ToString())
            </td>
            <td align="right">
                @{
            bal = (item.TaxAmount ?? 0) - (item.TaxReceipt ?? 0);
                }
                @bal
            </td>
            <td align="right">
                @(item.Advance == null ? "--" : item.Advance.ToString())
            </td>
            <td align="right">
                @(item.AdvanceAdjusted == null ? "--" : item.AdvanceAdjusted.ToString())
            </td>
            <td align="right">
                @{
            bal = (item.Advance ?? 0) - (item.AdvanceAdjusted ?? 0);
                }
                @bal
            </td>
        </tr>
           Count = Count + 1;
    }
    @if (Count == 1)
    {
        <tr class="TableRow">
            <td>
                Currently there are no Records
            </td>
        </tr> 
    }
</table>
<br />
<div>
    @Html.ActionLink("Back To Building Unit List", "Index", "SocietyBuildingUnit", new { societyBuildingID = societyBuildingUnit.SocietyBuilding.SocietyBuildingID, societySubscriptionID = ViewBag.SocietySubscriptionID }, new { @class = "EditDelete" })
</div>
