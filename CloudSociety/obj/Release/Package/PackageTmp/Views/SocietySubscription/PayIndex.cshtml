@model IEnumerable<CloudSocietyEntities.SocietySubscriptionWithServices>

@{
    ViewBag.Title = "Activate Societies";
    ViewBag.Header = "Activate Pending Subscriptions";
    @*Layout = "~/Views/Shared/SubscriberLayout.cshtml";*@
}

<script src="@Url.Content("~/Scripts/SocietySubscriptionCreate.js")" type="text/javascript"></script>

@using (Html.BeginForm())
{
<table border="0" cellpadding="2" cellspacing="0" class="table" id="tabSubscriptions">
@{
   int Count = 0;
}
@foreach (var item in Model)
{
    Count++;
    if (Count == 1)
    {
        <tr>
            <th></th>
            <th>
                Name
            </th>
            <th>
                Subscription Start
            </th>
            <th>
                Subscription End
            </th>
            <th>
                Members
            </th>
            <th>
                Months
            </th>
            <th>
                Services
            </th>
            <th>
                Amount
            </th>
        </tr>
     }

    <tr @if ((Count % 2) == 0)
        { <text> class="TableRow" </text> }
        else
        { <text> class="altTableRow" </text>}>
        <td>
            <input id="Chk+@Count" name="Chk+@Count" data-val="true" type="checkbox" checked="checked" onclick="CheckBoxForActivatePendingSubscriptions()" />
            <input id="ID+@Count" name="ID+@Count" data-val="true" type="hidden" value="@item.SocietySubscriptionID" />

        </td>
        <td>
            @item.Name
        </td>
        <td>
            @String.Format("{0:dd-MMM-yyyy}", item.SubscriptionStart)
        </td>
        <td>
            @String.Format("{0:dd-MMM-yyyy}", item.SubscriptionEnd)
        </td>
        <td>
            @item.NoOfMembers
        </td>
        <td>
            @item.SubscribedMonths
        </td>
        <td>
            @item.Services
        </td>
        <td>
            <label id="lblAmount+@Count" >@item.Amount</label>
        </td>
    </tr>
}
@if (Count > 0)
{
<tr class="altTableRow">
      
        <td colspan="6">&nbsp;</td>
        <td ><b>Net Amount</b></td>
        
        
        @{decimal TotalAmount = 0;}
        @foreach (var item in Model)
        {

            TotalAmount = TotalAmount + @item.Amount.Value;

        }
        <td colspan="1"  align="right"><b><label id="lblNetAmt" />@String.Format("{0:0.00}", TotalAmount)</b></td>
        
</tr>
<tr class="altTableRow">
        <td colspan="6">&nbsp;</td>
        <td ><b>@ViewBag.TaxPrompt</b><input id="TaxRate" type="hidden" value="@ViewBag.TaxPerc" /></td>
               
        @{
            decimal TaxAmount = 0;
            TaxAmount = (TotalAmount / 100) * ViewBag.TaxPerc;
         }
        <td colspan="1" align="right"><b><label id="lblTaxAmt" />@String.Format("{0:0.00}", TaxAmount)</b></td>
        
</tr>
<tr class="altTableRow">
        <td colspan="6">&nbsp;</td>
        <td ><b>Grand Total</b></td>
        
        @{
            decimal GrandTotal = 0;
            GrandTotal = TotalAmount + TaxAmount;
         }
        <td colspan="1"  align="right"><b><label id="lblTotAmt" />@String.Format("{0:0.00}", GrandTotal)</b></td>
        


       @Html.Hidden("NoOfSubscriptions", Count)
</tr>
}
</table>
if (Count > 0)
{

    //Show total of selected amounts + tax + grand total
    
       <br /><br />
    <input type="submit" value="Pay" class="buttton" style="width: 45px; height: 23px;
                        vertical-align: middle;" />
<br /><br />
}
else
{
    <p>
        No Pending Subscriptions
    </p>
}
}
<div>
    @Html.ActionLink("Back to List", "Index", "Society", null, new { @class = "EditDelete" })
</div>

<br />
