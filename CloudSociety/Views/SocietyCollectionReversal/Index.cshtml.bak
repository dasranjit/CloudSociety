@model IEnumerable<CloudSocietyEntities.SocietyCollectionReversal>
@{
    ViewBag.Title = "Society Collection Reversal";
    ViewBag.Header = "Society Collection Reversal List";
    ViewBag.SocietyNameHeader = ViewBag.SocietyHead;
    Layout = "~/Views/Shared/SocietyLayout.cshtml";
    var lockedTillDate = (DateTime?)ViewBag.LockedTillDate;
}
@if (!ViewBag.ReadOnly)
{
    <div class="buttton" style="width: 65px;">
        @Html.ActionLink("Create New", "Create", new { id = ViewBag.SocietySubscriptionID })</div>
    <br />         
}
<table border="0px" cellpadding="2" cellspacing="0" class="table">
    @{int Count = 1;}
    @foreach (var item in Model)
    {
        if (Count == 1)
        {
        <tr>
            <th>
            </th>
            <th>
                Bill Abbreviation
            </th>
            <th>
                Building Unit
            </th>
            <th>
                Society Member
            </th>
            <th>
                Reversal Date
            </th>
            <th>
                Receipt No
            </th>
            @*<th>
                Particulars
            </th>*@
            <th>
                Principal Adjusted
            </th>
            <th>
                Interest Adjusted
            </th>
            <th>
                NonChg Adjusted
            </th>
            <th>
                Tax Adjusted
            </th>
            <th>
                Advance
            </th>
        </tr> 
        }
        <tr @if ((Count % 2) == 0)
            {<text> class="TableRow"</text>}
            else
            {<text>class="altTableRow" </text>}>
            <td>
                @Html.ActionLink("Details", "Details", new { id = item.SocietyCollectionReversalID }, new { @class = "EditDelete" })
                @if (!ViewBag.ReadOnly && (lockedTillDate == null || item.ReversalDate > lockedTillDate))
                {
                    <text>|</text>
@*                    @Html.ActionLink("Edit", "Edit", new { id = item.SocietyCollectionReversalID }, new { @class = "EditDelete" })*@
                    @Html.ActionLink("Delete", "Delete", new { id = item.SocietyCollectionReversalID }, new { @class = "EditDelete" })
                }
            </td>
            <td>
                @item.BillAbbreviation
            </td>
            <td>
                @item.SocietyBuildingUnit.SocietyBuilding.Building <span>-</span> @item.SocietyBuildingUnit.Unit
            </td>
            <td>@item.SocietyMember.Member
            </td>
            <td>@String.Format("{0:dd-MMM-yyyy}", item.ReversalDate)
            </td>
            <td>@(item.SocietyReceipt != null ? item.SocietyReceipt.SocietyReceiptDetails : "")
            </td>
            @*<td>@(item.Particulars != null ? item.Particulars : "")
            </td>*@
            <td>@(item.PrincipalAdjusted != null ? item.PrincipalAdjusted.ToString() : "")
            </td>
            <td>@(item.InterestAdjusted != null ? item.InterestAdjusted.ToString() : "")
            </td>
            <td>@(item.NonChgAdjusted != null ? item.NonChgAdjusted.ToString() : "")
            </td>
            <td>@(item.TaxAdjusted != null ? item.TaxAdjusted.ToString() : "")
            </td>
            <td>@(item.Advance != null ? item.Advance.ToString() : "")
            </td>
        </tr>
                Count = Count + 1;
    }
    @if (Count == 1)
    {
        <tr class="TableRow">
            <td>
                Currently there are no Records
            </td>
        </tr> 
    }
</table>
<br />
<div>
    @Html.ActionLink("Back ", "Menu", "SocietySubscription", new { id = ViewBag.SocietySubscriptionID }, new { @class = "EditDelete" })
</div>
@*
@if (Model.Count() > 0)
{
    var grid = new WebGrid(Model, canPage: true, canSort: true, rowsPerPage: 10);
    grid.Pager(WebGridPagerModes.NextPrevious);
    WebGridColumn[] columnSet = new WebGridColumn[11];
    columnSet[0] = grid.Column("", "", format: @<text><div style='width: 70px'>@Html.ActionLink("Edit", "Edit", new { id = item.SocietyCollectionReversalID, backurl = grid.GetPageUrl(grid.PageIndex) }, new { @class = "EditDelete" })
        | @Html.ActionLink("Delete", "Delete", new { id = item.SocietyCollectionReversalID, backurl = grid.GetPageUrl(grid.PageIndex) }, new { @class = "EditDelete" })</div></text>, canSort: false);
    columnSet[1] = grid.Column("BillAbbreviation", "Bill Abbreviation", canSort: true);
    //columnSet[2] = grid.Column("SocietyBuildingUnitID", "Building Unit",format:(item)=> String.Format("",ViewBag.SocietyBuildingUnitList.Where(v=>v.SocietyBuildingUnitID==item.SocietyBuildingUnitID).BuildingUnit));
    columnSet[2] = grid.Column("SocietyBuildingUnit.Unit", "Building Unit");
    columnSet[3] = grid.Column("SocietyMember.Member", "Society Member");
    columnSet[4] = grid.Column("ReverseDate", "Reverse Date", format: (item) => String.Format("{0:dd-MMM-yyyy}", item.ReverseDate));
    columnSet[5] = grid.Column("SocietyReceipt.SocietyReceiptDetails", "Collection Receipt");
    columnSet[6] = grid.Column("Particulars", "Particulars");
    columnSet[7] = grid.Column("PrincipalAdjusted", "Principal Adjusted");
    columnSet[8] = grid.Column("InterestAdjusted", "Interest Adjusted");
    columnSet[9] = grid.Column("NonChgAdjusted", "NonChg Adjusted");
    columnSet[10] = grid.Column("TaxAdjusted", "Tax Adjusted");
    @grid.GetHtml(tableStyle: "table", footerStyle: "webgrid-footer", rowStyle: "TableRow", alternatingRowStyle: "altTableRow", columns: grid.Columns(columnSet))
}
else
{
    <table>
        <tr class="TableRow">
            <td>
                No Record Found.
            </td>
        </tr>
    </table> 
}
<br />
<div>
    @Html.ActionLink("Back ", "Menu", "SocietySubscription", new { id = ViewBag.SocietySubscriptionID }, new { @class = "EditDelete" })
</div>*@ 