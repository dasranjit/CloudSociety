@model CloudSocietyEntities.AcTransaction
@{
    ViewBag.Title = "Create Account Transaction";
    ViewBag.Header = "Account Transaction";
    ViewBag.SocietyNameHeader = ViewBag.SocietyHead;
    Layout = "~/Views/Shared/SocietyLayout.cshtml";
    var SocietySubscription = (CloudSocietyEntities.SocietySubscription)ViewBag.SocietySubscription;
    string DocType = (string)ViewBag.DocType;
    bool IsFullAccess = new CloudSociety.Controllers.AppInfoController().IsFullAccess();   
}
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/DateFuncs.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/SocietyReceipt.js")" type="text/javascript"></script>
@*==== Scripts to be added for AJAX calendar START ====*@
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/MicrosoftAjax.debug.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.ExtenderBase.BaseScripts.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.Common.Common.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.Common.DateTime.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.Animation.Animations.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.PopupExtender.PopupBehavior.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.Animation.AnimationBehavior.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.Common.Threading.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.Compat.Timer.Timer.js")"
        type="text/javascript"></script>
<script src="@Url.Content("~/Content/AjaxControlToolkit/3.0.20820.16598/3.0.20820.0/AjaxControlToolkit.Calendar.CalendarBehavior.js")"
        type="text/javascript"></script>
<script type="text/javascript">
    Sys.Application.add_init(appInit);
    function appInit() {
        $create(AjaxControlToolkit.CalendarBehavior, { format: "dd-MMM-yyyy" }, null, null, $get('DocDate'));
    } 
</script>
<script type="text/javascript">
    function CheckDocDate() {
        return (DateRangeCheck($("#DocDate").val(), $("#StartRange").val(), $("#EndRange").val()) && ValidateAcHead())
    }
    function ValidateAcHead() {      
        var achead = $get("AcHeadID");
        if (achead != null) {
            if ($("#AcHeadID").val() == "") {
                alert("Account Head must be selected !");
                return false;
            }
            else {
                return true;
            }
        }
        else {
            return true
        }
    }
</script>
@*==== END ====*@
<div>
    <span class="SocName">Document Type : @(DocType == "CP" ? "Cash Payment" : (DocType == "CR" ? "Cash Receipt" : (DocType == "BP" ? "Bank Payment" : (DocType == "BR" ? "Bank Receipt" : (DocType == "PB" ? "Puchase Bill" : (DocType == "EB" ? "Expense Bill" : (DocType == "SB" ? "SocietyBill" : (DocType == "JV" ? "Journal Voucher" : (DocType == "MC" ? "Member Collection" : (DocType == "OP" ? "Opening Balance" : (DocType == "YC" ? "Year End Closing Transaction" : "")))))))))))</span>
</div>
<br />
@using (Html.BeginForm())
{
    @Html.ValidationSummary(false, "Following errors occurred while processing your request")
    <fieldset style="width: 600px">
        <legend>Create Account Transaction</legend>
        <table border="0" cellpadding="0" cellspacing="0">
            @* <tr>
                <td>
                    Document Type :
                </td>
                <td>
                    @Html.Hidden("DocType", (string)ViewBag.DocType)
                    <strong>@(DocType == "C" ? "Cash Payment" : (DocType == "R" ? "Cash Receipt" : (DocType == "P" ? "Bank Payment" : (DocType == "B" ? "Bank Receipt" : (DocType == "U" ? "Purchase" : (DocType == "E" ? "Expense" : (DocType == "S" ? "Bill" : (DocType == "J" ? "Journal Voucher" : ""))))))))</strong>                    
                </td>
            </tr>
            <tr>
                <td>
                    Serial :
                </td>
                <td>
                    @Html.TextBox("Serial", null, new { @class = "shortWidth" })
                    <span class="editor-field">@Html.ValidationMessageFor(model => model.Serial)</span>
                </td>
            </tr>
            <tr>
                <td>
                    Document No :
                </td>
                <td>
                    @Html.TextBox("DocNo", null, new { @class = "shortWidth" })
                    <span class="editor-field">@Html.ValidationMessageFor(model => model.DocNo)</span>
                </td>
            </tr>*@
            <tr>
                <td>
                    Document Date :
                </td>
                <td>
                    @Html.TextBox("DocDate", null, new { @class = "shortWidth", onmouseover = "ShowLastBillDate()", onmouseout = "HideLastBillDate()", onkeypress="return false;", onkeydown="return false;" })
                    <div id="displayLastBillDate" style="visibility: hidden">
                        Document Date must be in between @String.Format("{0:dd-MMM-yyyy}", (DateTime)ViewBag.StartRange)
                        and @String.Format("{0:dd-MMM-yyyy}", (DateTime)ViewBag.EndRange)</div>
                    <span class="editor-field">@Html.ValidationMessageFor(model => model.DocDate)</span>
                </td>
            </tr>
            @if (DocType != "JV")
            {               
                <tr>
                    <td>
                        Account Head :
                    </td>
                    <td>
                        @Html.DropDownList("AcHeadID", new SelectList(ViewBag.AcHeadList as System.Collections.IEnumerable, "AcHeadID", "Name"), "<- Select Account Head->")
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.AcHeadID)</span>
                    </td>
                </tr>
                 
            }
            <tr>
                <td>
                    Particulars :
                </td>
                <td>
                    @Html.TextBox("Particulars", null, new { @class = "maxWidth" })@*@Html.EditorFor(model => model.Particulars)*@
                    <span class="editor-field">@Html.ValidationMessageFor(model => model.Particulars)</span>
                </td>
            </tr>
            @* <tr>
                <td>
                    Amount :
                </td>
                <td>
                    @Html.TextBox("Amount", null, new { @class = "shortWidth" })
                    <span class="editor-field">@Html.ValidationMessageFor(model => model.Amount)</span>
                </td>
            </tr>*@
            @if (DocType == "BP")
            {               
                <tr>
                    <td>
                        Cheque No. :
                    </td>
                    <td>
                        @Html.TextBox("PayRefNo", null, new { @class = "shortWidth" })
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.PayRefNo)</span>
                    </td>
                </tr>
                @Html.HiddenFor(model => model.PayRefDate) 
            }
            @if (DocType == "BR")
            {   
                <tr>
                    <td>
                        Pay Mode :
                    </td>
                    <td>
                        @Html.DropDownList("PayModeCode", new SelectList(ViewBag.PayModeList as System.Collections.IEnumerable, "PayModeCode", "PayMode"), "<- Select Pay Mode->")
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.PayModeCode)</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Pay Ref. No :
                    </td>
                    <td>
                        @Html.TextBox("PayRefNo", null, new { @class = "shortWidth" })@*@Html.EditorFor(model => model.PayRefNo)*@
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.PayRefNo)</span>
                    </td>
                </tr>
                <script type="text/javascript">
                    Sys.Application.add_init(appInit);
                    function appInit() {
                        $create(AjaxControlToolkit.CalendarBehavior, { format: "dd-MMM-yyyy" }, null, null, $get('PayRefDate'));
                    } 
                </script>
                <tr>
                    <td>
                        Pay Ref. Date :
                    </td>
                    <td>
                        @Html.TextBox("PayRefDate", null, new { @class = "shortWidth" })
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.PayRefDate)</span>
                    </td>
                </tr>    
                <tr>
                    <td>
                        Bank :
                    </td>
                    <td>
                        @Html.DropDownList("BankID", new SelectList(ViewBag.BankList as System.Collections.IEnumerable, "BankID", "Name"), "<- Select Bank->")
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.BankID)</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        Branch :
                    </td>
                    <td>
                        @Html.TextBox("Branch", null, new { @class = "maxWidth" })@*@Html.EditorFor(model => model.Branch)*@
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.Branch)</span>
                    </td>
                </tr>
            }
            @if (DocType == "SB" || DocType == "EB")
            {
                <tr>
                    <td>
                        Bill No :
                    </td>
                    <td>
                        @Html.TextBox("BillNo", null, new { @class = "mediumWidth" })@*@Html.EditorFor(model => model.BillNo)*@
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.BillNo)</span>
                    </td>
                </tr>
                <script type="text/javascript">
                    Sys.Application.add_init(appInit);
                    function appInit() {
                        $create(AjaxControlToolkit.CalendarBehavior, { format: "dd-MMM-yyyy" }, null, null, $get('BillDate'));
                    } 
                </script>
                <tr>
                    <td>
                        Bill Date :
                    </td>
                    <td>
                        @Html.TextBox("BillDate", null, new { @class = "shortWidth" })
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.BillDate)</span>
                    </td>
                </tr>
            }
            @if (DocType == "PB")
            {               
                <tr>
                    <td>
                        Bill No :
                    </td>
                    <td>
                        @Html.TextBox("BillNo", null, new { @class = "mediumWidth" })@*@Html.EditorFor(model => model.BillNo)*@
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.BillNo)</span>
                    </td>
                </tr>
                <script type="text/javascript">
                    Sys.Application.add_init(appInit);
                    function appInit() {
                        $create(AjaxControlToolkit.CalendarBehavior, { format: "dd-MMM-yyyy" }, null, null, $get('BillDate'));
                    } 
                </script>
                <tr>
                    <td>
                        Bill Date :
                    </td>
                    <td>
                        @Html.TextBox("BillDate", null, new { @class = "shortWidth" })
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.BillDate)</span>
                    </td>
                </tr>               
                <tr>
                    <td>
                        Delivery Document No :
                    </td>
                    <td>
                        @Html.TextBox("DelDocNo", null, new { @class = "mediumWidth" })@*@Html.EditorFor(model => model.DelDocNo)*@
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.DelDocNo)</span>
                    </td>
                </tr>
                <script type="text/javascript">
                    Sys.Application.add_init(appInit);
                    function appInit() {

                        $create(AjaxControlToolkit.CalendarBehavior, { format: "dd-MMM-yyyy" }, null, null, $get('DelDocDate'));
                    } 
                </script>
                <tr>
                    <td>
                        Delivery Document Date :
                    </td>
                    <td>
                        @Html.TextBox("DelDocDate", null, new { @class = "shortWidth" })
                        <span class="editor-field">@Html.ValidationMessageFor(model => model.DelDocDate)</span>
                    </td>
                </tr>
            }
            @if (IsFullAccess)
            {
                <tr>
                    <td colspan="2" align="center">
                        <input type="submit" value="Create" class="buttton" style="width: 45px; height: 23px;"
                            onclick="return CheckDocDate()" />
                    </td>
                </tr>
            }
        </table>
        @Html.Hidden("DocType", DocType)
        @Html.Hidden("SocietyID", SocietySubscription.SocietyID)
        @Html.Hidden("SocietySubscriptionID", SocietySubscription.SocietySubscriptionID)
        @Html.Hidden("EndRange", String.Format("{0:dd-MMM-yyyy}", (DateTime)ViewBag.EndRange))
        @Html.Hidden("StartRange", String.Format("{0:dd-MMM-yyyy}", (DateTime)ViewBag.StartRange))
    </fieldset>
}
@if (DocType == "YC")
{
    <div>
        @Html.ActionLink("Back", "Menu", "SocietySubscription", new { id = SocietySubscription.SocietySubscriptionID }, new { @class = "EditDelete" })
    </div>
}
else
{
    <div>
        @Html.ActionLink("Back to List", "Index", new { societySubscriptionID = SocietySubscription.SocietySubscriptionID, docType = ViewBag.DocType }, new { @class = "EditDelete" })
    </div>
}